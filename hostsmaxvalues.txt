select max(value::float) from graphite.autogen.hosts where direction = 'incoming' and  time > now() - 1d group by resource, time(1h) order by time desc